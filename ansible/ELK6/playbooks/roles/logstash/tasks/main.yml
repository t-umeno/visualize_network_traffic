- name: install logstash apt packages
  apt:
    name: "{{ packages }}"
    update_cache: yes
  vars:
    packages:
    - logstash
  become: yes
  when: opendistro_version is not defined
- name: install logstash-oss apt packages
  apt:
    name: "{{ packages }}"
    update_cache: yes
  vars:
    packages:
    - logstash-oss
  become: yes
  when: opendistro_version is defined
- name: copy logstash snort config file
  copy: src=files/logstash_snort.conf dest=/etc/logstash/conf.d/logstash_snort.conf
  become: yes
  when: snort_home_net is defined
- name: copy logstash config cluster file
  template: src=templates/logstash_ipfix.conf.cluster.j2 dest=/etc/logstash/conf.d/logstash_ipfix.conf
  become: yes
  notify: restart logstash
  when: elasticsearch_cluster is defined
- name: copy logstash config file
  template: src=templates/logstash_ipfix.conf.j2 dest=/etc/logstash/conf.d/logstash_ipfix.conf
  become: yes
  notify: restart logstash
  when: elasticsearch_cluster is not defined
